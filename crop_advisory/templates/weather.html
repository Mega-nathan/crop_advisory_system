<!-- Weather Data by accessing Current Location -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Weather Info</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Helvetica, Arial, sans-serif;
        margin: 0;
        background: #f0f2f5;
        color: #333;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }
      h1 {
        text-align: center;
        margin-bottom: 20px;
        color: #357abd;
      }
      button {
        display: block;
        margin: 0 auto 25px;
        padding: 12px 30px;
        font-size: 1.1rem;
        font-weight: 600;
        background-color: #4a90e2;
        border: none;
        border-radius: 8px;
        color: white;
        cursor: pointer;
        transition: background-color 0.3s, transform 0.2s;
      }
      button:hover {
        background-color: #357abd;
      }
      button:disabled {
        background-color: #a0c8f0;
        cursor: not-allowed;
      }
      #output {
        text-align: center;
      }
      .weather-section {
        margin-bottom: 40px;
      }
      .weather-section h2 {
        margin-bottom: 20px;
        color: #357abd;
        border-bottom: 2px solid #4a90e2;
        padding-bottom: 10px;
        font-size: 1.8rem;
      }
      .weather-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 25px;
        padding: 20px 0;
      }
      .weather-box {
        background-color: #fff;
        border-radius: 12px;
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
        padding: 25px;
        text-align: center;
        width: 220px;
        transition: transform 0.3s, box-shadow 0.3s;
      }
      .weather-box:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.12);
      }
      .weather-box h3 {
        margin-top: 0;
        margin-bottom: 15px;
        font-size: 1.2rem;
        color: #4a90e2;
      }
      .weather-box p {
        margin: 8px 0;
        font-size: 1rem;
      }
      .current-day {
        background-color: #eaf5ff;
        border: 2px solid #4a90e2;
        width: 280px;
      }
      .current-day h3 {
        font-size: 1.5rem;
      }
      .loader {
        border: 8px solid #f3f3f3;
        border-radius: 50%;
        border-top: 8px solid #4a90e2;
        width: 50px;
        height: 50px;
        animation: spin 1s linear infinite;
        margin: 20px auto;
      }
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
      @media (max-width: 600px) {
        .weather-container {
          justify-content: center;
        }
        .weather-box {
          width: 90%;
        }
        .current-day {
          width: 90%;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Weather Information</h1>
      <button id="getWeatherBtn">Get My Weather</button>
      <div id="loader" style="display: none"></div>
      <div id="output"></div>
    </div>

    <script>
      const weatherDescriptions = {
        0: "Clear sky",
        1: "Mainly clear",
        2: "Partly cloudy",
        3: "Overcast",
        45: "Fog",
        48: "Depositing rime fog",
        51: "Light drizzle",
        53: "Moderate drizzle",
        55: "Dense drizzle",
        56: "Light freezing drizzle",
        57: "Dense freezing drizzle",
        61: "Slight rain",
        63: "Moderate rain",
        65: "Heavy rain",
        66: "Light freezing rain",
        67: "Heavy freezing rain",
        71: "Slight snow fall",
        73: "Moderate snow fall",
        75: "Heavy snow fall",
        77: "Snow grains",
        80: "Slight rain showers",
        81: "Moderate rain showers",
        82: "Violent rain showers",
        85: "Slight snow showers",
        86: "Heavy snow showers",
        95: "Thunderstorm",
        96: "Thunderstorm slight hail",
        99: "Thunderstorm heavy hail",
      };

      const weatherIcons = {
        0: "☀️",
        1: "🌤️",
        2: "⛅",
        3: "☁️",
        45: "🌫️",
        48: "🌫️",
        51: "💧",
        53: "💧",
        55: "💧",
        56: "💧",
        57: "💧",
        61: "🌧️",
        63: "🌧️",
        65: "🌧️",
        66: "🌧️",
        67: "🌧️",
        71: "❄️",
        73: "❄️",
        75: "❄️",
        77: "❄️",
        80: "🌦️",
        81: "🌦️",
        82: "🌦️",
        85: "🌨️",
        86: "🌨️",
        95: "⛈️",
        96: "⛈️",
        99: "⛈️",
      };

      const output = document.getElementById("output");
      const btn = document.getElementById("getWeatherBtn");
      const loader = document.getElementById("loader");

      const formatDate = (dateStr) => {
        const d = new Date(dateStr);
        return d.toLocaleDateString(undefined, {
          weekday: "long",
          year: "numeric",
          month: "short",
          day: "numeric",
        });
      };

      async function fetchWeather(lat, lon, startDate, endDate) {
        const url =
          `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}` +
          `&daily=temperature_2m_max,temperature_2m_min,precipitation_sum,relative_humidity_2m_max,windspeed_10m_max,weathercode` +
          `&start_date=${startDate}&end_date=${endDate}&timezone=auto`;
        const res = await fetch(url);
        if (!res.ok) throw new Error("Failed to fetch weather data");
        return await res.json();
      }

      function displayWeather(title, weatherData, isCurrent = false) {
        const section = document.createElement("div");
        section.className = "weather-section";
        const heading = document.createElement("h2");
        heading.textContent = title;
        section.appendChild(heading);

        const cardsContainer = document.createElement("div");
        cardsContainer.className = "weather-container";

        weatherData.daily.time.forEach((date, i) => {
          const dayDiv = document.createElement("div");
          dayDiv.className = "weather-box";
          if (isCurrent) {
            dayDiv.classList.add("current-day");
          }
          dayDiv.innerHTML = `
          <h3>${formatDate(date)}</h3>
          <p><strong>Max Temp:</strong> ${
            weatherData.daily.temperature_2m_max[i]
          } °C</p>
          <p><strong>Min Temp:</strong> ${
            weatherData.daily.temperature_2m_min[i]
          } °C</p>
          <p><strong>Precipitation:</strong> ${
            weatherData.daily.precipitation_sum[i]
          } mm</p>
          <p><strong>Humidity:</strong> ${
            weatherData.daily.relative_humidity_2m_max[i]
          } %</p>
          <p><strong>Wind Speed:</strong> ${
            weatherData.daily.windspeed_10m_max[i]
          } km/h</p>
          <p style="font-size: 1.5rem;">${
            weatherIcons[weatherData.daily.weathercode[i]] || ""
          }</p>
          <p>${
            weatherDescriptions[weatherData.daily.weathercode[i]] ||
            "No description"
          }</p>
        `;
          cardsContainer.appendChild(dayDiv);
        });

        section.appendChild(cardsContainer);
        output.appendChild(section);
      }

      async function getWeather() {
        output.innerHTML = "";
        loader.style.display = "block";
        btn.disabled = true;

        if (!navigator.geolocation) {
          output.textContent = "Geolocation is not supported by your browser.";
          loader.style.display = "none";
          btn.disabled = false;
          return;
        }

        navigator.geolocation.getCurrentPosition(
          async (position) => {
            const lat = position.coords.latitude;
            const lon = position.coords.longitude;
            output.textContent = "";

            const today = new Date();
            const todayStr = today.toISOString().split("T")[0];
            const pastStart = new Date(today);
            pastStart.setDate(today.getDate() - 5);
            const pastStartStr = pastStart.toISOString().split("T")[0];
            const pastEnd = new Date(today);
            pastEnd.setDate(today.getDate() - 1);
            const pastEndStr = pastEnd.toISOString().split("T")[0];
            const futureStart = new Date(today);
            futureStart.setDate(today.getDate() + 1);
            const futureStartStr = futureStart.toISOString().split("T")[0];
            const futureEnd = new Date(today);
            futureEnd.setDate(today.getDate() + 5);
            const futureEndStr = futureEnd.toISOString().split("T")[0];

            try {
              const currentData = await fetchWeather(
                lat,
                lon,
                todayStr,
                todayStr
              );
              displayWeather("Current Day's Weather", currentData, true);

              const pastData = await fetchWeather(
                lat,
                lon,
                pastStartStr,
                pastEndStr
              );
              displayWeather("Past 5 Days Weather", pastData);

              const futureData = await fetchWeather(
                lat,
                lon,
                futureStartStr,
                futureEndStr
              );
              displayWeather("Next 5 Days Forecast", futureData);
            } catch (error) {
              output.textContent = `Error: ${error.message}`;
            } finally {
              loader.style.display = "none";
              btn.disabled = false;
            }
          },
          () => {
            output.textContent = "Unable to retrieve your location.";
            loader.style.display = "none";
            btn.disabled = false;
          }
        );
      }

      btn.addEventListener("click", getWeather);
      window.addEventListener("load", getWeather);
    </script>
  </body>
</html>
